---
title: "Part_2_Frog_Species"
author: "Heyue WU_u7628175"
date: "15/09/2023"
output:  
    html_document:
        toc: true
        toc_depth: 4
        theme: cosmo
        number_sections: false
        toc_float: true
        highlight: pygments
        fig_width: 8
        fig_height: 4
---

# Location on GitHub

https://github.com/AdriaWu/DS4B-short-report-1//blob/main/DS4B-short-report-1/Part_2_Frog_Species.Rmd

## 1. Loading the data and preparing for the packages

```{r}
# Load necessary R packages
library(tidyverse)
library(ggplot2)
library(readxl)
library(dplyr)
library(lubridate)

# Read data from Excel file
data_2 <- read_csv("raw_data/FrogID4_final_dataset.csv")

# have a quick view of the data
tibble(data_2)

# Check the type of value
summary(data_2)
```

## 2. Data Cleaning and Preliminary Analysis

The next step is to identify any anomalies, inconsistencies, or missing values.

```{r}
# Check for missing values and use the `summarise_all()` to summarize or calculate all columns in a data frame
data_2 |>
  summarise_all(~sum(is.na(.)))
```
This means that all rows of these columns have valid data, with no missing values. Then let's check for duplicates.

```{r}
# use the `duplicated()` function to identify and count duplicate rows.
sum(duplicated(data_2))
```
So there are no duplicate rows in the data_2. 

Before diving into any analysis or visualization, we can make a summary of the dataset to provide a quick snapshot of key features for the data, which might help the readers who are unfamiliar with the dataset.

```{r}
# Number of unique species
unique_species <- length(unique(data_2$scientificName))

# Get range of dates

# The original date data is in character format, and we can just find the start date and end date.
start_Date <- as.character(min(data_2$eventDate))
end_Date <- as.character(max(data_2$eventDate))

# Distribution of recordings across states
state_distribution <- table(data_2$stateProvince)

# Print the summary
cat("Summary of the Dataset:\n")
cat("-----------------------\n")
cat("Number of Unique Species Recorded:", unique_species, "\n")
cat("Range of Dates: From", start_Date, "to", end_Date, "\n")
cat("Distribution of Recordings Across States:\n")
print(state_distribution)
```
We can know that the dataset has recorded a total of 199 unique species. The recordings span from the date 2017-11-10 to 2021-11-09. And with 229,000 recordings, NSW dominates the dataset, accounting for a significant portion of the total recordings.

## 3. Plot the species discovery curve for Australia

After a preliminary analysis of the data, we can plot the species discovery curve for Australia as a whole. This will show the cumulative number of species discovered over time.

```{r}
# Convert the `eventDate` column into standardized Date objects and create a new column to store them, ensuring consistency across the dataset and better visualization later.
data_2$Date_Object <- as.Date(data_2$eventDate, format="%Y/%m/%d")

# Sort the data by date
data_sorted <- data_2 |>
  arrange(Date_Object) |>
  group_by(Date_Object) |>
  # Count the number of unique species on each date and then summarize them.
  summarise(unique_species = n_distinct(scientificName)) |>
  # Create a new column representing the cumulative number of species discovered so far, which includes the number of species on all previous dates.
  mutate(cumulative_species = cumsum(unique_species))

# Use ggplot2 to plot the species discovery curve for Australia as whole
plot_1 <- ggplot(data_sorted, aes(x = Date_Object, y = cumulative_species)) +
  geom_line(color = "#2E86C1", linewidth = 1) +
  
  labs(title = "Species Discovery Curve for Australia",
       x = "Date",
       y = "Cumulative Number of Species Discovered") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title.x = element_text(size = 12, face = "bold"),
    axis.title.y = element_text(size = 14, face = "bold"),
    axis.text.x = element_text(size = 12),
    axis.text.y = element_text(size = 12),
    panel.grid.minor = element_line(color = "gray90"),
    panel.grid.major = element_line(color = "gray80")
    ) 

# Extract the first and last dates of the data_sorted 
first_date <- data_sorted[1, ]
last_date <- data_sorted[nrow(data_sorted), ]

# Add points and date labels
plot_1 <- plot_1 +
  geom_point(data = first_date, aes(x = Date_Object, y = cumulative_species), color = "#E74C3C", size = 3) +
  geom_point(data = last_date, aes(x = Date_Object, y = cumulative_species), color = "#E74C3C", size = 3) +
  geom_text(data = first_date, 
            aes(x = Date_Object, 
                y = cumulative_species,
                label = "2017-11-10"), 
            vjust = -3, 
            hjust = 0.25, 
            size = 3, 
            color = "#E74C3C") +
  geom_text(data = last_date, 
            aes(x = Date_Object, 
                y = cumulative_species, 
                label = "2021-11-09"), 
            vjust = 1.5, 
            hjust = 1.25, 
            size = 3, 
            color = "#E74C3C")

print(plot_1)

```
From plot_1, we can see that by the date 2021-11-09, the cumulative number of species discovered has already exceeded 45,000.


```{r}
# Sort and group data by date and state
data_sorted_statewise <- data_2 |>
  arrange(eventDate) |>
  group_by(eventDate, stateProvince) |>
  summarise(unique_species = n_distinct(scientificName), .groups = "drop") |>
  group_by(stateProvince) |>
  mutate(cumulative_species = cumsum(unique_species))

# Use ggplot2 to plot the species discovery curve for each state
plot_2 <- ggplot(data_sorted_statewise, aes(x = eventDate, y = cumulative_species, color = stateProvince)) +
  geom_line() +
  labs(title = "Species Discovery Curve by State",
       x = "Date",
       y = "Cumulative Number of Species Discovered") +
  theme_minimal() 
  
print(plot_2)
```


